<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Option Groups &mdash; nidaba 0.9.7-6-g5a8da99
 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.7-6-g5a8da99
',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="nidaba 0.9.7-6-g5a8da99
 documentation" href="index.html" />
    <link rel="next" title="TEI Output" href="tei.html" />
    <link rel="prev" title="Plugins" href="plugins.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="option-groups">
<h1>Option Groups<a class="headerlink" href="#option-groups" title="Permalink to this headline">¶</a></h1>
<div class="section" id="preprocessing">
<span id="img"></span><h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<p>Several useful preprocessing tasks are grouped in here.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba batch ... -i any_to_png ... -- *.tif
</pre></div>
</div>
<div class="section" id="options-and-syntax">
<h3>Options and Syntax<a class="headerlink" href="#options-and-syntax" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nidaba.tasks.img.any_to_png">
<code class="descclassname">nidaba.tasks.img.</code><code class="descname">any_to_png</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.img.any_to_png" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an image (color or otherwise) in any format recognized by pillow
to PNG.</p>
<p>The pillow image library relies on external libraries for loading and
saving Image data. To recognize the most common image formats used for
digital archival you&#8217;ll need:</p>
<ul class="simple">
<li>libtiff</li>
<li>zlib</li>
<li>libjpeg</li>
<li>openjpeg (version 2.0 +)</li>
<li>libwebp</li>
</ul>
<p>To have access to all formats run (on Debian/Ubuntu):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> apt-get -y install libtiff5-dev libjpeg62-turbo-dev zlib1g-dev             libwebp-dev libopenjp2-dev
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; The input document tuple</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to all output files.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output file</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nidaba.tasks.img.rgb_to_gray">
<code class="descclassname">nidaba.tasks.img.</code><code class="descname">rgb_to_gray</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.img.rgb_to_gray" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an arbitrary bit depth image to grayscale and writes it back
appending a suffix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; The input document tuple</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to all output files.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output file</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="binarization">
<span id="bin"></span><h2>Binarization<a class="headerlink" href="#binarization" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Thresholding_%28image_processing%29">Binarization</a> is the
process of converting a grayscale image to a bi-level image by selecting one or
more thresholds separating foreground (usually the text to be recognized) from
background (usually the white page) pixels. As all character recognition
methods implemented in nidaba operate only on bi-level images, it is paramount
to create properly binarized images as a preprocessing step.</p>
<p>Binarization is an own group of tasks and functions can be accessed using the
<code class="docutils literal"><span class="pre">--binarization/-b</span></code> switch:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba batch ... -b otsu -b sauvola:... -- *.tif
</pre></div>
</div>
<div class="section" id="id2">
<h3>Options and Syntax<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nidaba.tasks.binarize.otsu">
<code class="descclassname">nidaba.tasks.binarize.</code><code class="descname">otsu</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.binarize.otsu" title="Permalink to this definition">¶</a></dt>
<dd><p>Binarizes an input document utilizing a naive implementation of Otsu&#8217;s
thresholding.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; The input document tuple.</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to all output files.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output file</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>There are also additional, more advanced binarization algorithms available in
the <a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.leptonica" title="nidaba.plugins.leptonica"><code class="xref py py-mod docutils literal"><span class="pre">leptonica</span></code></a> and <a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.kraken" title="nidaba.plugins.kraken"><code class="xref py py-mod docutils literal"><span class="pre">kraken</span></code></a> plugins.</p>
</div>
</div>
<div class="section" id="page-segmentation">
<span id="segmentation-heading"></span><h2>Page Segmentation<a class="headerlink" href="#page-segmentation" title="Permalink to this headline">¶</a></h2>
<p>A prerequisite to the actual OCR is the extraction of textual elements,
columns, paragraphs, and lines, from the page. Page segmentation is a separate
group of tasks and functions can be accessed using the <code class="docutils literal"><span class="pre">--segmentation/-l</span></code>
switch:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> nidaba batch ... -l tesseract ... -- *.tif
</pre></div>
</div>
<div class="section" id="id3">
<h3>Options and Syntax<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Segmentation is usually an integral part of an OCR engine, so different
implementations are situated in their respective plugins. See <a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.tesseract" title="nidaba.plugins.tesseract"><code class="xref py py-mod docutils literal"><span class="pre">tesseract</span></code></a> and <a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.kraken" title="nidaba.plugins.kraken"><code class="xref py py-mod docutils literal"><span class="pre">kraken</span></code></a> for
additional information.</p>
</div>
</div>
<div class="section" id="optical-character-recognition">
<span id="ocr-heading"></span><h2>Optical Character Recognition<a class="headerlink" href="#optical-character-recognition" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Optical_character_recognition">OCR</a> is arguably
the main part of nidaba. Currently 3 OCR engines are implemented and can be
accessed using the <code class="docutils literal"><span class="pre">--ocr</span></code> group of task:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba batch ... -o tesseract:languages<span class="o">=</span><span class="se">\[</span>eng<span class="se">\]</span> -o kraken:model<span class="o">=</span>en-default ... -- *.tif
</pre></div>
</div>
<div class="section" id="id4">
<h3>Options and Syntax<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>As OCR engines are usually quite large and sometimes hard to install, all
functionality is contained in plugins. See <a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.tesseract" title="nidaba.plugins.tesseract"><code class="xref py py-mod docutils literal"><span class="pre">tesseract</span></code></a>, <a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.kraken" title="nidaba.plugins.kraken"><code class="xref py py-mod docutils literal"><span class="pre">kraken</span></code></a>, and
<a class="reference internal" href="source/nidaba.plugins.html#module-nidaba.plugins.ocropus" title="nidaba.plugins.ocropus"><code class="xref py py-mod docutils literal"><span class="pre">ocropus</span></code></a> for additional information,
configuration keys, etc.</p>
</div>
</div>
<div class="section" id="spell-checking">
<span id="id5"></span><h2>Spell Checking<a class="headerlink" href="#spell-checking" title="Permalink to this headline">¶</a></h2>
<p>Nidaba includes support for an edit distance based spell checker out of the
box. Particular configurations of the spell checking algorithm have to be
predefined in the <code class="docutils literal"><span class="pre">nidaba.yaml</span></code> configuration file under the <code class="docutils literal"><span class="pre">lang_dicts</span></code>
section:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">lang_dicts</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">polytonic_greek</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span><span class="nv">dictionary</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">dicts</span><span class="p-Indicator">,</span> <span class="nv">greek.dic</span><span class="p-Indicator">],</span>
                    <span class="nv">deletion_dictionary</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">dicts</span><span class="p-Indicator">,</span> <span class="nv">del_greek.dic</span><span class="p-Indicator">]}</span>
  <span class="l-Scalar-Plain">latin</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span><span class="nv">dictionary</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">dicts</span><span class="p-Indicator">,</span> <span class="nv">latin.dic</span><span class="p-Indicator">],</span>
                    <span class="nv">deletion_dictionary</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">dicts</span><span class="p-Indicator">,</span> <span class="nv">del_latin.dic</span><span class="p-Indicator">]}</span>
</pre></div>
</div>
<p>The spell-checker is part of the postprocessing group of tasks and can be
accessed be the name <code class="docutils literal"><span class="pre">spell_check</span></code>, e.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba batch ... -p spell_check:language<span class="o">=</span>polytonic_greek,filter_punctuation<span class="o">=</span>False ... -- *.tif
</pre></div>
</div>
<div class="section" id="creating-dictionaries">
<h3>Creating Dictionaries<a class="headerlink" href="#creating-dictionaries" title="Permalink to this headline">¶</a></h3>
<p>The spell checker requires two dictionaries on the common storage medium: a
dictionary of valid word forms and a corresponding file containing a mapping
between variants and those valid word forms. Both are best created using the
<code class="docutils literal"><span class="pre">nidaba_mkdict</span></code> tool installed by the default distribution. It takes a
arbitrary text document, extracts all unique character sequences, and
calculates the dictionaries in a normalized format. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba_mkdict --input greek.txt --del_dict del_greek.dic --dictionary greek.dic
<span class="go">Reading input file      [✓]</span>
<span class="go">Writing dictionary      [✓]</span>
<span class="go">Writing deletions       [✓]</span>
</pre></div>
</div>
<p>Be aware that calculating the deletion dictionary is a process requiring a lot
of memory, e.g. for a 31Mb word list mkdict utilizes around 8Gb memory and the
resulting deletion dictionary will be 750Mb large.</p>
</div>
<div class="section" id="id6">
<h3>Options and Syntax<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nidaba.tasks.postprocessing.spell_check">
<code class="descclassname">nidaba.tasks.postprocessing.</code><code class="descname">spell_check</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em>, <em>language</em>, <em>filter_punctuation</em>, <em>no_ocrx_words</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.postprocessing.spell_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds spelling suggestions to an TEI XML document.</p>
<p>Alternative spellings for each segment will be included in a choice
tagcontaining a series of corr tags with the original segment appearing
beneath a sic element.  Correct words, i.e. words appearing verbatim in the
dictionary, are left untouched.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; The input document tuple.</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to the output file.</li>
<li><strong>language</strong> (<em>unicode</em>) &#8211; Identifier defined in the nidaba configuration as a
valid dictionary.</li>
<li><strong>filter_punctuation</strong> (<em>bool</em>) &#8211; Switch to filter punctuation inside
<code class="docutils literal"><span class="pre">seg</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output document</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="output-merging">
<span id="merging"></span><h2>Output Merging<a class="headerlink" href="#output-merging" title="Permalink to this headline">¶</a></h2>
<p>There is a rudimentary merging algorithm able to combine multiple recognition
results into a single document if certain conditions are met. The combined
output can then be used for further postprocessing, e.g manual correction or
lexicality based weighting. It has been ported from Bruce Robertson&#8217;s
<a class="reference external" href="https://github.com/brobertson/rigaudon">rigaudon</a>, an OCR engine for
polytonic Greek.</p>
<p>Currently, its basic operation is as follows. First (word) bboxes from all
documents are roughly matched, then all matching bboxes are scored using a
spell checker. If no spell checker is available all matches will be merged
without ranking.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The matching is naive, i.e. we just grab the first input document and
assume that all other documents have similar segmentation results.
Issues like high variance in segmentation, especially word boundaries
are not accounted for.</p>
</div>
<div class="section" id="id7">
<h3>Options and Syntax<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nidaba.tasks.postprocessing.blend_hocr">
<code class="descclassname">nidaba.tasks.postprocessing.</code><code class="descname">blend_hocr</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em>, <em>language</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.postprocessing.blend_hocr" title="Permalink to this definition">¶</a></dt>
<dd><p>Blends multiple hOCR files using the algorithm I cooked up in between
thesis procrastination sessions. It is language independent and
parameterless.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>[</strong> (<em>doc</em>) &#8211; A list of storage module tuples that will be</li>
<li><strong>into a single output document.</strong> (<em>merged</em>) &#8211; </li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to the output file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output document</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="output-layer">
<span id="id8"></span><h2>Output Layer<a class="headerlink" href="#output-layer" title="Permalink to this headline">¶</a></h2>
<p>The output layer handles conversion and extension of nidaba&#8217;s native <a class="reference internal" href="tei.html#tei-output"><span>TEI</span></a> format. It can be used to distill data from the TEI document into
plain text, hOCR, and a simple XML format. It can also use an external metadata
file to complete raw TEI output to a valid TEI document.</p>
<p>An example adding metadata from an external file using the <code class="docutils literal"><span class="pre">file:</span></code> syntax to
copy it to the storage medium on task invocation:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba batch ...  -f metadata:metadata<span class="o">=</span>file:openphilology_meta.yaml,validate<span class="o">=</span>False -- *.tif
</pre></div>
</div>
<div class="section" id="id9">
<h3>Options and Syntax<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nidaba.tasks.output.tei_metadata">
<code class="descclassname">nidaba.tasks.output.</code><code class="descname">tei_metadata</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em>, <em>metadata</em>, <em>validate</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.output.tei_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Enriches a TEI-XML document with various metadata from an user-supplied
YAML file.</p>
<p>The following fields may be contained in the metadata file with the bolded
subset mandatory for a valid TEI-XML file. They are grouped by their place
in the header. Unknown fields are ignored and input is escaped as to
disable injection.</p>
<p>Some element may also be extended by increasing their arity, the second
value is then usually used as a global identifer/locator, i.e. an URL or
authority control ID.</p>
<p>titleStmt:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal"><span class="pre">title</span></code>: Title of the resource</p>
</li>
<li><p class="first">author: Name of the author of the resource (may be extended)</p>
</li>
<li><dl class="first docutils">
<dt>editor: Name of the editor, compiler, translator, etc. of the</dt>
<dd><p class="first last">resource (may be extended)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>funder: Institution responsible for the funding of the text (may be</dt>
<dd><p class="first last">extended)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>principal: PI responsible for the creation of the text (may be</dt>
<dd><p class="first last">extended)</p>
</dd>
</dl>
</li>
<li><p class="first">sponsor: Name of the sponsoring institution (may be extended)</p>
</li>
<li><p class="first">meeting: Conference/meeting resulting in the text (may be extended)</p>
</li>
</ul>
</div></blockquote>
<p>editionStmt:</p>
<blockquote>
<div><ul class="simple">
<li>edition: Peculiarities to the underlying edition of the text</li>
</ul>
</div></blockquote>
<p>publicationStmt:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal"><span class="pre">licence</span></code>: Licence of the content (may be extended)</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">publisher</span></code>: Person or agency responsible for the publication of</dt>
<dd><p class="first last">the text (may be extended)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>distributor: Person or agency responsible for the text&#8217;s</dt>
<dd><p class="first last">distribution (may be extended)</p>
</dd>
</dl>
</li>
<li><p class="first">authority: Authority responsible for making the work available</p>
</li>
<li><dl class="first docutils">
<dt>idno: Identifier of the publication (may be extended with the type of</dt>
<dd><p class="first last">identifier)</p>
</dd>
</dl>
</li>
<li><p class="first">pub_place: Place of publication</p>
</li>
<li><p class="first">date: Date of publication</p>
</li>
</ul>
</div></blockquote>
<p>seriesStmt:</p>
<blockquote>
<div><ul class="simple">
<li>series_title: Title of the series to which the publication belongs</li>
</ul>
</div></blockquote>
<p>notesStmt:</p>
<blockquote>
<div><ul class="simple">
<li>note: Misc. notes about the text</li>
</ul>
</div></blockquote>
<p>sourceDesc:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">source_desc</span></code>: Description of the source document</li>
</ul>
</div></blockquote>
<p>other:</p>
<blockquote>
<div><ul class="simple">
<li>lang: Abbreviation of the language used in the header</li>
</ul>
</div></blockquote>
<p>There is a sample file from the OpenPhilology project in the example
directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; Storage tuple of the input document</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; </li>
<li><strong>metadata</strong> (<em>unicode, unicode</em>) &#8211; Storage tuple of the metadata YAML file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output document</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">(unicode, unicode)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>NidabaTEIException if the resulting document is not TEI compatible and</li>
<li>validation is enabled.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nidaba.tasks.output.tei2abbyyxml">
<code class="descclassname">nidaba.tasks.output.</code><code class="descname">tei2abbyyxml</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.output.tei2abbyyxml" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a TEI Facsimile to a format similar to Abbyy FineReader&#8217;s XML
output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; Storage tuple of the input document</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Storage tuple of the output document</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(unicode, unicode)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nidaba.tasks.output.tei2hocr">
<code class="descclassname">nidaba.tasks.output.</code><code class="descname">tei2hocr</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.output.tei2hocr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a TEI Facsimile to hOCR preserving as much metadata as possible.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; Storage tuple of the input document</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Storage tuple of the output document</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(unicode, unicode)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nidaba.tasks.output.tei2txt">
<code class="descclassname">nidaba.tasks.output.</code><code class="descname">tei2txt</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.output.tei2txt" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a TEI Facsimile to a plain text file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; Storage tuple of the input document</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Storage tuple of the output document</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(unicode, unicode)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="metrics">
<span id="id10"></span><h2>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h2>
<p>It is possible to calculate metrics on the textual output to assess its
deviation from a given ground truth. The ground truth may be in one of several
supported formats including plain text, hOCR, and TEI XML. Currently two
schemes for calculating character edit distances are included; one using a
variant of the well-known <code class="docutils literal"><span class="pre">diff</span></code> algorithm and a task calculating the global
minimal edit distance:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba batch ... -s text_edit_ratio:ground_truth<span class="o">=</span>file:<span class="s1">&#39;*.gt.txt&#39;</span>,xml_in<span class="o">=</span>True,clean_gt<span class="o">=</span>True,gt_format<span class="o">=</span>text,clean_in<span class="o">=</span>True,divert<span class="o">=</span>True -- *.tif
</pre></div>
</div>
<p>Note that we didn&#8217;t associate a single ground truth with the batch but a
pattern matching one more ground truth files. On runtime the task automatically
selects the needed ground truth for its OCR result based on the filename prefix.</p>
<p>Access to the metric is provided by the usual <code class="docutils literal"><span class="pre">status</span></code> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> nidaba status 481964c3-fe5d-487a-9b73-a12869678ab3
<span class="go">Status: success (final)</span>

<span class="go">3/3 tasks completed. 0 running.</span>

<span class="go">Output files:</span>

<span class="go">0016.tif → 0016_ocr.kraken_teubner.xml (94.0% / 0016.gt.txt)</span>
</pre></div>
</div>
<p>As you can see we got an accuracy of 94% on our scans which is good but not great.</p>
<div class="section" id="id11">
<h3>Options and Syntax<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="nidaba.tasks.stats.text_diff_ratio">
<code class="descclassname">nidaba.tasks.stats.</code><code class="descname">text_diff_ratio</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em>, <em>ground_truth</em>, <em>xml_in</em>, <em>gt_format</em>, <em>clean_in</em>, <em>clean_gt</em>, <em>divert</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.stats.text_diff_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the similarity of the input documents and a given ground truth
using the algorithm of python&#8217;s difflib SequenceMatcher. The result is a
value between 0.0 (no commonality) and 1.0 (identical strings).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; The input document tuple</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to the output file.</li>
<li><strong>ground_truth</strong> (<em>unicode</em>) &#8211; Ground truth location tuple or a list of ground
truths to choose from. When more than one is
given, the file sharing the longest prefix with
the input document is chosen.</li>
<li><strong>xml_in</strong> (<em>bool</em>) &#8211; Switch to treat input as an TEI-XML document.</li>
<li><strong>gt_format</strong> (<em>unicode</em>) &#8211; Switch to select ground truth format. Valid values
are &#8216;tei&#8217;, &#8216;hocr&#8217;, and &#8216;text&#8217;.</li>
<li><strong>clean_in</strong> (<em>bool</em>) &#8211; Normalize to NFD and strip input data. (DO NOT DISABLE!)</li>
<li><strong>clean_gt</strong> (<em>bool</em>) &#8211; Normalize to NFD and strip ground truth. (DO NOT DISABLE!)</li>
<li><strong>divert</strong> (<em>bool</em>) &#8211; Switch selecting output diversion. If enabled the output
will be added to the tracking arguments and the input
document will be returned as the result of the task. Use
this to insert a statistical measure into a chain
without affecting the results.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output document</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nidaba.tasks.stats.text_edit_ratio">
<code class="descclassname">nidaba.tasks.stats.</code><code class="descname">text_edit_ratio</code><span class="sig-paren">(</span><em>doc</em>, <em>method</em>, <em>ground_truth</em>, <em>xml_in</em>, <em>gt_format</em>, <em>clean_in</em>, <em>clean_gt</em>, <em>divert</em><span class="sig-paren">)</span><a class="headerlink" href="#nidaba.tasks.stats.text_edit_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the similarity of the input documents and a given ground truth
using the Damerau-Levenshtein distance. The result is a value between 0.0
(no commonality) and 1.0 (identical strings).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>doc</strong> (<em>unicode, unicode</em>) &#8211; The input document tuple</li>
<li><strong>method</strong> (<em>unicode</em>) &#8211; The suffix string appended to the output file.</li>
<li><strong>ground_truth</strong> (<em>unicode</em>) &#8211; Ground truth location tuple or a list of ground
truths to choose from. When more than one is
given, the file sharing the longest prefix with
the input document is chosen.</li>
<li><strong>xml_in</strong> (<em>bool</em>) &#8211; Switch to treat input as an TEI-XML document.</li>
<li><strong>gt_format</strong> (<em>unicode</em>) &#8211; Switch to select ground truth format. Valid values
are &#8216;tei&#8217;, &#8216;hocr&#8217;, and &#8216;text&#8217;.</li>
<li><strong>clean_in</strong> (<em>bool</em>) &#8211; Normalize to NFD and strip input data. (DO NOT DISABLE!)</li>
<li><strong>clean_gt</strong> (<em>bool</em>) &#8211; Normalize to NFD and strip ground truth. (DO NOT DISABLE!)</li>
<li><strong>divert</strong> (<em>bool</em>) &#8211; Switch selecting output diversion. If enabled the output
will be added to the tracking arguments and the input
document will be returned as the result of the task. Use
this to insert a statistical measure into a chain
without affecting the results.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Storage tuple of the output document</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(unicode, unicode)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">nidaba</a></h1>



<p class="blurb">An expandable and scalable OCR pipeline</p>



<p>
<iframe src="https://ghbtns.com/github-btn.html?user=openphilology&repo=nidaba&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




    

<p>
<a href="https://travis-ci.org/OpenPhilology/nidaba">
    <img
        alt="https://secure.travis-ci.org/OpenPhilology/nidaba.png?branch=master"
        src="https://secure.travis-ci.org/OpenPhilology/nidaba.png?branch=master"
    >
</a>
</p>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Option Groups</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#binarization">Binarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#page-segmentation">Page Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optical-character-recognition">Optical Character Recognition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spell-checking">Spell Checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-merging">Output Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-layer">Output Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metrics">Metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tei.html">TEI</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">API Docs</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014-2015, Open Greek and Latin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/options.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>